{% extends 'base.html' %}
{% block title %} cfs|homepage {% endblock %}
{% load static %}
{% block scripts_in_the_head %} 
    <script  src="{% static 'js/view_project.js'%}"></script>
{% endblock %}
{% block css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/projects_templates.css' %}">
<style>
    .artefact{
        background-color:var(--primary-8);
        color:var(--font-color-10);
        border:1px solid var(--primary-10);
    }

    .primary{
        background-color:var(--btn-primary);
        color:var(--font-color-10);
    }
    
    .secondary{
        background-color:var(--btn-secondary);
        color:var(--font-color-6);
    }
    .done{
        background-color:var(--primary-8-alpha);
        color:var(--font-color-6);
    }
    .task-done{
        background-color:var(--primary-8-alpha);
        color:var(--font-color-6);
        text-decoration: line-through;
    }
</style>
{% endblock %}
{% block content %}
<main class="container-fluid my-5" id="main">   
    <div class="row">
        <div class="col-10 offset-1">
            <h1 class="text-center project-name text-info"> {{ project.name }} </h1>
            <p>
                {{ project.description }}
            </p>
        </div>
    </div>
    <div class="row">
        <div class="col-10 offset-1">
            {% if project.wireframe != '' %}
            <div class="d-flex flex-column align-items-center">
                <img src="{{project.wireframe.url}}" alt="project wireframe" class="img-fluid">
                <div>
                    <a href="{% url 'projects:delete_wireframe' id=project.id %}" class="btn btn-danger mt-2">Delete Wireframe</a>
                </div>
            </div>
            {% else %}
                <div id="projectWireFrame">
                    <button id="addWireFrame" class="btn primary" onclick="addWireFrame('projectWireFrame')">Add WireFrame</button>
                </div>
            {% endif %}
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <H2 class="text-center my-3">Project Requirements</H2>
            <ul class="list-group my-2" id="requirements-list">
                {% for requirement in requirements %}
                <li class="list-group-item artefact {{requirement.complete|yesno:'done,artefact'}}" id="requirement-{{requirement.id}}">
                    <div class="d-flex flex-wrap justify-content-between">
                        <p class="ml-2" id="requirement-info-{{requirement.id}}">{{ requirement.description }}</p>
                        {% if requirement.id != 'error' %}
                        <div class="d-flex flex-wrap justify-content-between">
                            <button class="btn primary btn-sm mx-2"> version {{requirement.version}}</button>
                            <a href="{% url 'projects:delete_feature' id=requirement.id file_class='requirements' id_project=project.id %}" class="delete-requirement btn btn-block btn-danger btn-sm">Delete</a>
                        </div>
                        {% endif %}
                    </div>
                </li>
                {% endfor %}
            </ul>
            <input type="hidden" value="{{project.id}}" id="id_project">
            <input type="hidden" value="{{request.session.user_id}}" id="user_id">
            <div id="form-add-requirements">
                <button class="add-feature btn primary" id="new_requirements"> Add Requirements </button>
            </div>
        </div>
        <input type="hidden" id="detect-changes" value="change">
        <div class="row">
            <div class="col-12">
                <h2 class="text-center">TO DO List</h2>
                <ul class="list-group" id="tasks-list">
                    {% for todo in to_dos %}
                    <li id="ToDo-{{todo.id}}" class="list-group-item {{todo_todo.complete|yesno:'task-done,artefact'}}">
                        <div class="d-flex flex-wrap justify-content-between">
                            <p class="ml-2" id="ToDo-info-{{todo.id}}">{{ todo.description }}</p>
                            {% if todo.id != 'error' %}
                            <div class="d-flex flex-wrap justify-content-between">
                                <button class="btn btn-block primary btn-sm">{{todo.version}}</button>
                                <a href="{% url 'projects:delete_feature' id=todo.id file_class='ToDo' id_project=project.id %}" class="delete-task btn btn-block btn-danger btn-sm">Delete</a>
                            </div>
                            {% endif %}
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>           
        </div>
        <div id="form-add-to_dos">
            <button class="add-feature btn primary my-2" id="ToDo"> Add Tasks </button>
        </div>
        <div class="row my-3">
            <div class=" col-10 offset-1 d-flex flex-column align-items-center">
                {% if project.user_flow_image != '' %}
                    <img src="{{project.user_flow_image.url}}" alt="user flw" class="img-fluid">
                    <div>
                        <a href="{% url 'projects:delete_user_flow_image' id=project.id %}" class="btn btn-danger my-2"> Delete Image</a>
                    </div>
                {% else %}
                    <div id="userFlowImage">
                        <button id="addUserFlowImage" class="btn secondary" onclick="addUserFlowImage('userFlowImage',{{project.id}})">Add User Flow Image</button>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="col-10 offset-1 offset-md-3 offset-lg-5">
        <a href="{% url 'projects:edit_project' project.id %}" class="btn primary" id="edit"> Edit Project </a>
        <a href="{% url 'projects:delete_project' project.id %}" class="btn btn-danger my-2" id="delete"> Delete Project </a>
    </div>
</main>
{% endblock %}
{% block js %}
{{ block.super }}
<script src="{% static 'js/create_project.js'%}"></script>
{% endblock %}
